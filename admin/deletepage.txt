<h2>Delete page</h2>
<?php

/*

Please see gpl.txt for licence and disclaimer of warranty.

Seemes CMS
Copyright 2007 MagicWare
Filename: deletepage.txt
Description: Admin Control Panel module; delete a page.

This software is released under the GPL licence. Please see gpl.txt.

*/

?>
<form action="action.php" method="post">
<fieldset>
<input type="hidden" name="action" value="deletepage" />
<label for="pagefilename">Page name:</label><br />
<?php

// List the pages. We can't use listpages() in this instance because listpages() automatically echoes everything, and we need to have the raw list so we can remove the home page from it before we echo it.

// Get the filenames.
$filename = glob($websitedatadir . "*" . $websitedataextension);

// Make sure there are some files...
if (count($filename) > 1) {
	for ($i = 0; $i < count($filename); $i++) {
		// Chop $datadir off the filename.
		$filename[$i] = substr($filename[$i], strlen($websitedatadir), strlen($filename[$i]) - strlen($websitedatadir));
		// Now remove the file extension.
		$filename[$i] = substr($filename[$i], 0, strlen($filename[$i]) - strlen($websitedataextension));
	}
	
	// Now remove index.htm.
	$websitedefaultpageindex = array_search($websitedefaultpage, $filename);
	if ($websitedefaultpageindex !== false) {
		unset($filename[$websitedefaultpageindex]);
	}

	// Echo the dropdown list.
	echo("<select name=\"pagefilename\" id=\"pagefilename\">\n");
	foreach ($filename as $filename) {
		echo("<option value=\"" . $filename . "\">" . $filename . "</option>\n");
	}
	echo("</select><br />\n");
	echo("<input type=\"submit\" value=\"Delete page\" />");
}
else {
	echo("<span id=\"pagefilename\">There are no pages to delete!</span>");
}

?>
</fieldset>
</form>
<br />
<div style="background-color: #ffe0e0; border: 1px solid #ff0000; color: #000000"><b>Please note:</b> This is <i>permanent</i>! It is impossible to reverse the deletion process. If you want the page back, you'll have to type it all out again or restore from a backup.</div>